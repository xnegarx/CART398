{"version":3,"file":"osc.min.js","sources":["../src/common/utils.js","../src/common/helpers.js","../src/atomic.js","../src/atomic/int32.js","../src/atomic/string.js","../src/atomic/timetag.js","../src/atomic/blob.js","../src/atomic/float32.js","../src/atomic/float64.js","../src/atomic/int64.js","../src/atomic/uint64.js","../src/atomic/constant.js","../src/message.js","../src/bundle.js","../src/packet.js","../src/events.js","../src/plugin/plugin.js","../src/plugin/dgram.js","../src/external/ws.js","../src/plugin/bridge.js","../src/plugin/wsclient.js","../src/plugin/wsserver.js","../src/osc.js"],"sourcesContent":["/**\n * Check if given object is an integer number\n * @param {*} n\n * @return {boolean}\n */\nexport function isInt(n) {\n  return Number(n) === n && n % 1 === 0\n}\n\n/**\n * Check if given object is a float number\n * @param {*} n\n * @return {boolean}\n */\nexport function isFloat(n) {\n  return Number(n) === n && n % 1 !== 0\n}\n\n/**\n * Check if given object is a number\n * @param {*} n\n * @return {boolean}\n */\nexport function isNumber(n) {\n  return Number(n) === n\n}\n\n/**\n * Check if given object is a string\n * @param {*} n\n * @return {boolean}\n */\nexport function isString(n) {\n  return typeof n === 'string'\n}\n\n/**\n * Check if given object is a boolean\n * @param {*} n\n * @return {boolean}\n */\nexport function isBoolean(n) {\n  return typeof n === 'boolean'\n}\n\n/**\n * Check if given object is infinity constant\n * @param {*} n\n * @return {boolean}\n */\nexport function isInfinity(n) {\n  return n === Infinity\n}\n\n/**\n * Check if given object is an array\n * @param {*} n\n * @return {boolean}\n */\nexport function isArray(n) {\n  return Object.prototype.toString.call(n) === '[object Array]'\n}\n\n/**\n * Check if given object is an object\n * @param {*} n\n * @return {boolean}\n */\nexport function isObject(n) {\n  return Object.prototype.toString.call(n) === '[object Object]'\n}\n\n/**\n * Check if given object is a function\n * @param {*} n\n * @return {boolean}\n */\nexport function isFunction(n) {\n  return typeof n === 'function'\n}\n\n/**\n * Check if given object is a Uint8Array\n * @param {*} n\n * @return {boolean}\n */\nexport function isBlob(n) {\n  return n instanceof Uint8Array\n}\n\n/**\n * Check if given object is a Date\n * @param {*} n\n * @return {boolean}\n */\nexport function isDate(n) {\n  return n instanceof Date\n}\n\n/**\n * Check if given object is undefined\n * @param {*} n\n * @return {boolean}\n */\nexport function isUndefined(n) {\n  return typeof n === 'undefined'\n}\n\n/**\n * Check if given object is null\n * @param {*} n\n * @return {boolean}\n */\nexport function isNull(n) {\n  return n === null\n}\n\n/**\n * Return the next multiple of four\n * @param {number} n\n */\nexport function pad(n) {\n  return (n + 3) & ~0x03\n}\n\n/**\n * Checks if environment provides a feature\n * @param {string} name Name of needed feature\n * @return {boolean}\n */\nexport function hasProperty(name) {\n  return Object.prototype.hasOwnProperty.call(\n    (typeof global !== 'undefined' ? global : window), // eslint-disable-line no-undef\n    name,\n  )\n}\n\n/**\n * Wrap binary data in DataView\n * @param {*} obj\n * @return {DataView}\n */\nexport function dataView(obj) {\n  if (obj.buffer) {\n    return new DataView(obj.buffer)\n  } else if (obj instanceof ArrayBuffer) {\n    return new DataView(obj)\n  }\n\n  return new DataView(new Uint8Array(obj))\n}\n","import {\n  isArray,\n  isBlob,\n  isBoolean,\n  isFloat,\n  isInfinity,\n  isInt,\n  isNull,\n  isString,\n} from './utils'\n\n/**\n * Checks type of given object and returns the regarding OSC\n * Type tag character\n * @param {*} item Any object\n * @return {string} OSC Type tag character\n */\nexport function typeTag(item) {\n  if (isInt(item)) {\n    return 'i'\n  } else if (isFloat(item)) {\n    return 'f'\n  } else if (isString(item)) {\n    return 's'\n  } else if (isBlob(item)) {\n    return 'b'\n  } else if (isBoolean(item)) {\n    return item ? 'T' : 'F'\n  } else if (isNull(item)) {\n    return 'N'\n  } else if (isInfinity(item)) {\n    return 'I'\n  }\n\n  throw new Error('OSC typeTag() found unknown value type')\n}\n\n/**\n * Sanitizes an OSC-ready Address Pattern\n * @param {string[]|string} obj Address as string or array of strings\n * @return {string} Corrected address string\n *\n * @example\n * // all calls return '/test/path' string:\n * prepareAddress('test/path')\n * prepareAddress('/test/path/')\n * prepareAddress([test, path])\n */\nexport function prepareAddress(obj) {\n  let address = ''\n\n  if (isArray(obj)) {\n    return `/${obj.join('/')}`\n  } else if (isString(obj)) {\n    address = obj\n\n    // remove slash at ending of address\n    if (address.length > 1 && address[address.length - 1] === '/') {\n      address = address.slice(0, address.length - 1)\n    }\n\n    // add slash at beginning of address\n    if (address.length > 1 && address[0] !== '/') {\n      address = `/${address}`\n    }\n\n    return address\n  }\n\n  throw new Error('OSC prepareAddress() needs addresses of type array or string')\n}\n\n/**\n * Make an OSC address pattern javascript-regex-ready\n * @param {string} str OSC address pattern\n * @return {string} Javascript RegEx string\n */\nexport function prepareRegExPattern(str) {\n  let pattern\n\n  if (!(isString(str))) {\n    throw new Error('OSC prepareRegExPattern() needs strings')\n  }\n\n  pattern = str.replace(/\\./g, '\\\\.')\n  pattern = pattern.replace(/\\(/g, '\\\\(')\n  pattern = pattern.replace(/\\)/g, '\\\\)')\n\n  pattern = pattern.replace(/\\{/g, '(')\n  pattern = pattern.replace(/\\}/g, ')')\n  pattern = pattern.replace(/,/g, '|')\n\n  pattern = pattern.replace(/\\[!/g, '[^')\n\n  pattern = pattern.replace(/\\?/g, '.')\n  pattern = pattern.replace(/\\*/g, '.*')\n\n  return pattern\n}\n\n/**\n * Holds a list of items and helps to merge them\n * into a single array of packed binary data\n */\nexport default class EncodeHelper {\n  /**\n   * Create a new EncodeHelper instance\n   */\n  constructor() {\n    /** @type {array} data */\n    this.data = []\n    /** @type {number} byteLength */\n    this.byteLength = 0\n  }\n\n  /**\n   * Packs an item and adds it to the list\n   * @param {*} item Any object\n   * @return {EncodeHelper}\n   */\n  add(item) {\n    // Skip encoding items which do not need a payload as they are constants\n    if (isBoolean(item) || isInfinity(item) || isNull(item)) {\n      return this\n    }\n\n    const buffer = item.pack()\n    this.byteLength += buffer.byteLength\n    this.data.push(buffer)\n\n    return this\n  }\n\n  /**\n   * Merge all added items into one Uint8Array\n   * @return {Uint8Array} Merged binary data array of all items\n   */\n  merge() {\n    const result = new Uint8Array(this.byteLength)\n    let offset = 0\n\n    this.data.forEach((data) => {\n      result.set(data, offset)\n      offset += data.byteLength\n    })\n\n    return result\n  }\n}\n","import { isUndefined } from './common/utils'\n\n/**\n * Base class for OSC Atomic Data Types\n */\nexport default class Atomic {\n  /**\n   * Create an Atomic instance\n   * @param {*} [value] Initial value of any type\n   */\n  constructor(value) {\n    /** @type {*} value */\n    this.value = value\n    /** @type {number} offset */\n    this.offset = 0\n  }\n\n  /**\n   * Interpret the given value of this entity as packed binary data\n   * @param {string} method The DataView method to write to the ArrayBuffer\n   * @param {number} byteLength Size of array in bytes\n   * @return {Uint8Array} Packed binary data\n   */\n  pack(method, byteLength) {\n    if (!(method && byteLength)) {\n      throw new Error('OSC Atomic cant\\'t be packed without given method or byteLength')\n    }\n\n    const data = new Uint8Array(byteLength)\n    const dataView = new DataView(data.buffer)\n\n    if (isUndefined(this.value)) {\n      throw new Error('OSC Atomic cant\\'t be encoded with empty value')\n    }\n\n    // use DataView to write to ArrayBuffer\n    dataView[method](this.offset, this.value, false)\n\n    // always return binary Uint8Array after packing\n    return data\n  }\n\n  /**\n   * Unpack binary data from DataView according to the given format\n   * @param {DataView} dataView The DataView holding the binary representation of the value\n   * @param {string} method The DataView method to read the format from the ArrayBuffer\n   * @param {number} byteLength Size of array in bytes\n   * @param {number} [initialOffset=0] Offset of DataView before unpacking\n   * @return {number} Offset after unpacking\n   */\n  unpackWithMethod(dataView, method, byteLength, initialOffset = 0) {\n    if (!(dataView && method && byteLength)) {\n      throw new Error('OSC Atomic cant\\'t be unpacked without given dataView, method or byteLength')\n    }\n\n    if (!(dataView instanceof DataView)) {\n      throw new Error('OSC Atomic expects an instance of type DataView')\n    }\n\n    // use DataView to read from ArrayBuffer and add offset\n    this.value = dataView[method](initialOffset, false)\n    this.offset = initialOffset + byteLength\n\n    // always return offset number after unpacking\n    return this.offset\n  }\n}\n","import { isInt } from '../common/utils'\n\nimport Atomic from '../atomic'\n\n/**\n * 32-bit big-endian two's complement integer OSC Atomic Data Type\n */\nexport default class AtomicInt32 extends Atomic {\n  /**\n   * Create an AtomicInt32 instance\n   * @param {number} [value] Initial integer value\n   */\n  constructor(value) {\n    if (value && !isInt(value)) {\n      throw new Error('OSC AtomicInt32 constructor expects value of type number')\n    }\n\n    super(value)\n  }\n\n  /**\n   * Interpret the given number as packed binary data\n   * @return {Uint8Array} Packed binary data\n   */\n  pack() {\n    return super.pack('setInt32', 4)\n  }\n\n  /**\n   * Unpack binary data from DataView and read a Int32 number\n   * @param {DataView} dataView The DataView holding the binary representation of the value\n   * @param {number} [initialOffset=0] Offset of DataView before unpacking\n   * @return {number} Offset after unpacking\n   */\n  unpack(dataView, initialOffset = 0) {\n    return super.unpackWithMethod(dataView, 'getInt32', 4, initialOffset)\n  }\n}\n","import {\n  hasProperty,\n  isString,\n  isUndefined,\n  pad,\n} from '../common/utils'\n\nimport Atomic from '../atomic'\n\n/** Slice size of large strings for fallback method */\nconst STR_SLICE_SIZE = 65537\n\n/** Text encoding format */\nconst STR_ENCODING = 'utf-8'\n\n/**\n * Helper method to decode a string using different methods depending on environment\n * @param {number[]} charCodes Array of char codes\n * @return {string} Decoded string\n */\nfunction charCodesToString(charCodes) {\n  // Use these methods to be able to convert large strings\n  if (hasProperty('Buffer')) {\n    return Buffer.from(charCodes).toString(STR_ENCODING)\n  } else if (hasProperty('TextDecoder')) {\n    return new TextDecoder(STR_ENCODING) // eslint-disable-line no-undef\n      .decode(new Int8Array(charCodes))\n  }\n\n  // Fallback method\n  let str = ''\n\n  for (let i = 0; i < charCodes.length; i += STR_SLICE_SIZE) {\n    str += String.fromCharCode.apply(\n      null,\n      charCodes.slice(i, i + STR_SLICE_SIZE),\n    )\n  }\n\n  return str\n}\n\n/**\n * A sequence of non-null ASCII characters OSC Atomic Data Type\n */\nexport default class AtomicString extends Atomic {\n  /**\n   * Create an AtomicString instance\n   * @param {string} [value] Initial string value\n   */\n  constructor(value) {\n    if (value && !isString(value)) {\n      throw new Error('OSC AtomicString constructor expects value of type string')\n    }\n\n    super(value)\n  }\n\n  /**\n   * Interpret the given string as packed binary data\n   * @return {Uint8Array} Packed binary data\n   */\n  pack() {\n    if (isUndefined(this.value)) {\n      throw new Error('OSC AtomicString can not be encoded with empty value')\n    }\n\n    // add 0-3 null characters for total number of bits a multiple of 32\n    const terminated = `${this.value}\\u0000`\n    const byteLength = pad(terminated.length)\n\n    const buffer = new Uint8Array(byteLength)\n\n    for (let i = 0; i < terminated.length; i += 1) {\n      buffer[i] = terminated.charCodeAt(i)\n    }\n\n    return buffer\n  }\n\n  /**\n   * Unpack binary data from DataView and read a string\n   * @param {DataView} dataView The DataView holding the binary representation of the string\n   * @param {number} [initialOffset=0] Offset of DataView before unpacking\n   * @return {number} Offset after unpacking\n   */\n  unpack(dataView, initialOffset = 0) {\n    if (!(dataView instanceof DataView)) {\n      throw new Error('OSC AtomicString expects an instance of type DataView')\n    }\n\n    let offset = initialOffset\n    let charcode\n    const charCodes = []\n\n    for (; offset < dataView.byteLength; offset += 1) {\n      charcode = dataView.getUint8(offset)\n\n      // check for terminating null character\n      if (charcode !== 0) {\n        charCodes.push(charcode)\n      } else {\n        offset += 1\n        break\n      }\n    }\n\n    if (offset === dataView.length) {\n      throw new Error('OSC AtomicString found a malformed OSC string')\n    }\n\n    /** @type {number} offset */\n    this.offset = pad(offset)\n    /** @type {string} value */\n    this.value = charCodesToString(charCodes)\n\n    return this.offset\n  }\n}\n","import {\n  isDate,\n  isInt,\n  isUndefined,\n} from '../common/utils'\n\nimport Atomic from '../atomic'\n\n/** 70 years in seconds */\nexport const SECONDS_70_YEARS = 2208988800\n/** 2^32 */\nexport const TWO_POWER_32 = 4294967296\n\n/**\n * Timetag helper class for representing NTP timestamps\n * and conversion between them and javascript representation\n */\nexport class Timetag {\n  /**\n   * Create a Timetag instance\n   * @param {number} [seconds=0] Initial NTP *seconds* value\n   * @param {number} [fractions=0] Initial NTP *fractions* value\n   */\n  constructor(seconds = 0, fractions = 0) {\n    if (!(isInt(seconds) && isInt(fractions))) {\n      throw new Error('OSC Timetag constructor expects values of type integer number')\n    }\n\n    /** @type {number} seconds */\n    this.seconds = seconds\n    /** @type {number} fractions */\n    this.fractions = fractions\n  }\n\n  /**\n   * Converts from NTP to JS representation and back\n   * @param {number} [milliseconds] Converts from JS milliseconds to NTP.\n   * Leave empty for converting from NTP to JavaScript representation\n   * @return {number} Javascript timestamp\n   */\n  timestamp(milliseconds) {\n    let seconds\n\n    if (typeof milliseconds === 'number') {\n      seconds = milliseconds / 1000\n      const rounded = Math.floor(seconds)\n\n      this.seconds = rounded + SECONDS_70_YEARS\n      this.fractions = Math.round(TWO_POWER_32 * (seconds - rounded))\n\n      return milliseconds\n    }\n\n    seconds = this.seconds - SECONDS_70_YEARS\n    return (seconds + Math.round(this.fractions / TWO_POWER_32)) * 1000\n  }\n}\n\n/**\n * 64-bit big-endian fixed-point time tag, semantics\n * defined below OSC Atomic Data Type\n */\nexport default class AtomicTimetag extends Atomic {\n  /**\n   * Create a AtomicTimetag instance\n   * @param {number|Timetag|Date} [value] Initial date, leave empty if\n   * you want it to be the current date\n   */\n  constructor(value = Date.now()) {\n    let timetag = new Timetag()\n\n    if (value instanceof Timetag) {\n      timetag = value\n    } else if (isInt(value)) {\n      timetag.timestamp(value)\n    } else if (isDate(value)) {\n      timetag.timestamp(value.getTime())\n    }\n\n    super(timetag)\n  }\n\n  /**\n   * Interpret the given timetag as packed binary data\n   * @return {Uint8Array} Packed binary data\n   */\n  pack() {\n    if (isUndefined(this.value)) {\n      throw new Error('OSC AtomicTimetag can not be encoded with empty value')\n    }\n\n    const { seconds, fractions } = this.value\n    const data = new Uint8Array(8)\n    const dataView = new DataView(data.buffer)\n\n    dataView.setInt32(0, seconds, false)\n    dataView.setInt32(4, fractions, false)\n\n    return data\n  }\n\n  /**\n   * Unpack binary data from DataView and read a timetag\n   * @param {DataView} dataView The DataView holding the binary representation of the timetag\n   * @param {number} [initialOffset=0] Offset of DataView before unpacking\n   * @return {number} Offset after unpacking\n   */\n  unpack(dataView, initialOffset = 0) {\n    if (!(dataView instanceof DataView)) {\n      throw new Error('OSC AtomicTimetag expects an instance of type DataView')\n    }\n\n    const seconds = dataView.getUint32(initialOffset, false)\n    const fractions = dataView.getUint32(initialOffset + 4, false)\n\n    /** @type {Timetag} value */\n    this.value = new Timetag(seconds, fractions)\n    /** @type {number} offset */\n    this.offset = initialOffset + 8\n\n    return this.offset\n  }\n}\n","import {\n  isBlob,\n  isUndefined,\n  pad,\n} from '../common/utils'\n\nimport Atomic from '../atomic'\n\n/**\n * 8-bit bytes of arbitrary binary data OSC Atomic Data Type\n */\nexport default class AtomicBlob extends Atomic {\n  /**\n   * Create an AtomicBlob instance\n   * @param {Uint8Array} [value] Binary data\n   */\n  constructor(value) {\n    if (value && !isBlob(value)) {\n      throw new Error('OSC AtomicBlob constructor expects value of type Uint8Array')\n    }\n\n    super(value)\n  }\n\n  /**\n   * Interpret the given blob as packed binary data\n   * @return {Uint8Array} Packed binary data\n   */\n  pack() {\n    if (isUndefined(this.value)) {\n      throw new Error('OSC AtomicBlob can not be encoded with empty value')\n    }\n\n    const byteLength = pad(this.value.byteLength)\n    const data = new Uint8Array(byteLength + 4)\n    const dataView = new DataView(data.buffer)\n\n    // an int32 size count\n    dataView.setInt32(0, this.value.byteLength, false)\n    // followed by 8-bit bytes of arbitrary binary data\n    data.set(this.value, 4)\n\n    return data\n  }\n\n  /**\n   * Unpack binary data from DataView and read a blob\n   * @param {DataView} dataView The DataView holding the binary representation of the blob\n   * @param {number} [initialOffset=0] Offset of DataView before unpacking\n   * @return {number} Offset after unpacking\n   */\n  unpack(dataView, initialOffset = 0) {\n    if (!(dataView instanceof DataView)) {\n      throw new Error('OSC AtomicBlob expects an instance of type DataView')\n    }\n\n    const byteLength = dataView.getInt32(initialOffset, false)\n\n    /** @type {Uint8Array} value */\n    this.value = new Uint8Array(dataView.buffer, initialOffset + 4, byteLength)\n    /** @type {number} offset */\n    this.offset = pad(initialOffset + 4 + byteLength)\n\n    return this.offset\n  }\n}\n","import { isNumber } from '../common/utils'\n\nimport Atomic from '../atomic'\n\n/**\n * 32-bit big-endian IEEE 754 floating point number OSC Atomic Data Type\n */\nexport default class AtomicFloat32 extends Atomic {\n  /**\n   * Create an AtomicFloat32 instance\n   * @param {number} [value] Float number\n   */\n  constructor(value) {\n    if (value && !isNumber(value)) {\n      throw new Error('OSC AtomicFloat32 constructor expects value of type float')\n    }\n\n    super(value)\n  }\n\n  /**\n   * Interpret the given number as packed binary data\n   * @return {Uint8Array} Packed binary data\n   */\n  pack() {\n    return super.pack('setFloat32', 4)\n  }\n\n  /**\n   * Unpack binary data from DataView and read a Float32 number\n   * @param {DataView} dataView The DataView holding the binary representation of the value\n   * @param {number} [initialOffset=0] Offset of DataView before unpacking\n   * @return {number} Offset after unpacking\n   */\n  unpack(dataView, initialOffset = 0) {\n    return super.unpackWithMethod(dataView, 'getFloat32', 4, initialOffset)\n  }\n}\n","import { isNumber } from '../common/utils'\n\nimport Atomic from '../atomic'\n\n/**\n * 64-bit big-endian IEEE 754 floating point number OSC Atomic Data Type\n */\nexport default class AtomicFloat64 extends Atomic {\n  /**\n   * Create an AtomicFloat64 instance\n   * @param {number} [value] Float number\n   */\n  constructor(value) {\n    if (value && !isNumber(value)) {\n      throw new Error('OSC AtomicFloat64 constructor expects value of type float')\n    }\n\n    super(value)\n  }\n\n  /**\n   * Interpret the given number as packed binary data\n   * @return {Uint8Array} Packed binary data\n   */\n  pack() {\n    return super.pack('setFloat64', 8)\n  }\n\n  /**\n   * Unpack binary data from DataView and read a Float64 number\n   * @param {DataView} dataView The DataView holding the binary representation of the value\n   * @param {number} [initialOffset=0] Offset of DataView before unpacking\n   * @return {number} Offset after unpacking\n   */\n  unpack(dataView, initialOffset = 0) {\n    return super.unpackWithMethod(dataView, 'getFloat64', 8, initialOffset)\n  }\n}\n","import Atomic from '../atomic'\n\nconst MAX_INT64 = BigInt('9223372036854775807')\nconst MIN_INT64 = BigInt('-9223372036854775808')\n\n/**\n * 64-bit big-endian two's complement integer OSC Atomic Data Type\n */\nexport default class AtomicInt64 extends Atomic {\n  /**\n   * Create an AtomicInt64 instance\n   * @param {number} [value] Initial integer value\n   */\n  constructor(value) {\n    if (value && typeof value !== 'bigint') {\n      throw new Error('OSC AtomicInt64 constructor expects value of type BigInt')\n    }\n\n    if (value && (value < MIN_INT64 || value > MAX_INT64)) {\n      throw new Error('OSC AtomicInt64 value is out of bounds')\n    }\n\n    let tmp\n    if (value) {\n      tmp = BigInt.asIntN(64, value)\n    }\n\n    super(tmp)\n  }\n\n  /**\n   * Interpret the given number as packed binary data\n   * @return {Uint8Array} Packed binary data\n   */\n  pack() {\n    return super.pack('setBigInt64', 8)\n  }\n\n  /**\n   * Unpack binary data from DataView and read a Int64 number\n   * @param {DataView} dataView The DataView holding the binary representation of the value\n   * @param {number} [initialOffset=0] Offset of DataView before unpacking\n   * @return {number} Offset after unpacking\n   */\n  unpack(dataView, initialOffset = 0) {\n    return super.unpackWithMethod(dataView, 'getBigInt64', 8, initialOffset)\n  }\n}\n","import Atomic from '../atomic'\n\nconst MAX_UINT64 = BigInt('18446744073709551615')\n\n/**\n * Unsigned 64-bit big-endian two's complement integer OSC Atomic Data Type\n */\nexport default class AtomicUInt64 extends Atomic {\n  /**\n   * Create an AtomicUInt64 instance\n   * @param {number} [value] Initial integer value\n   */\n  constructor(value) {\n    if (value && typeof value !== 'bigint') {\n      throw new Error('OSC AtomicUInt64 constructor expects value of type BigInt')\n    }\n\n    if (value && (value < 0 || value > MAX_UINT64)) {\n      throw new Error('OSC AtomicUInt64 value is out of bounds')\n    }\n\n    let tmp\n    if (value) {\n      tmp = BigInt.asUintN(64, value)\n    }\n\n    super(tmp)\n  }\n\n  /**\n   * Interpret the given number as packed binary data\n   * @return {Uint8Array} Packed binary data\n   */\n  pack() {\n    return super.pack('setBigUint64', 8)\n  }\n\n  /**\n   * Unpack binary data from DataView and read a UInt64 number\n   * @param {DataView} dataView The DataView holding the binary representation of the value\n   * @param {number} [initialOffset=0] Offset of DataView before unpacking\n   * @return {number} Offset after unpacking\n   */\n  unpack(dataView, initialOffset = 0) {\n    return super.unpackWithMethod(dataView, 'getBigUint64', 8, initialOffset)\n  }\n}\n","/**\n * Extended boolean type without data representing \"True\"\n */\nexport const VALUE_TRUE = true\n\n/**\n * Extended boolean type without data representing \"False\"\n */\nexport const VALUE_FALSE = false\n\n/**\n * Extended type without data representing \"None\"\n * @type {null}\n */\nexport const VALUE_NONE = null\n\n/**\n * Extended type without data representing \"Infinity\"\n */\nexport const VALUE_INFINITY = Infinity\n","import {\n  isArray,\n  isString,\n  isUndefined,\n} from './common/utils'\n\nimport Helper, { typeTag, prepareAddress } from './common/helpers'\n\nimport AtomicBlob from './atomic/blob'\nimport AtomicFloat32 from './atomic/float32'\nimport AtomicFloat64 from './atomic/float64'\nimport AtomicInt32 from './atomic/int32'\nimport AtomicInt64 from './atomic/int64'\nimport AtomicUInt64 from './atomic/uint64'\nimport AtomicString from './atomic/string'\nimport {\n  VALUE_NONE, VALUE_TRUE, VALUE_FALSE, VALUE_INFINITY,\n} from './atomic/constant'\n\n/**\n * A TypedMessage consists of an OSC address and an optional array of typed OSC arguments.\n *\n * @typedef {'i'|'f'|'s'|'b'|'h'|'t'|'d'|'T'|'F'|'N'|'I'} MessageArgType\n *\n * - `i` - int32\n * - `f` - float32\n * - `s` - string\n * - `b` - blob\n * - `h` - int64\n * - `t` - uint64\n * - `d` - double\n * - `T` - True (no argument data)\n * - `F` - False (no argument data)\n * - `N` - Nil (no argument data)\n * - `I` - Infinitum (no argument data)\n *\n * @typedef {number|string|Blob|VALUE_TRUE|VALUE_FALSE|VALUE_NONE|VALUE_INFINITY} MessageArgValue\n *\n * @typedef {object} MessageArgObject\n * @property {MessageArgType} type\n * @property {MessageArgValue} value\n *\n * @example\n * const messageArgObject = {\n *   type: 'i', value: 123\n * }\n */\nexport class TypedMessage {\n  /**\n   * Create a TypedMessage instance\n   * @param {string[]|string} address Address\n   * @param {MessageArgValue[]} args Arguments\n   *\n   * @example\n   * const message = new TypedMessage(['test', 'path'])\n   * message.add('d', 123.123456789)\n   * message.add('s', 'hello')\n   *\n   * @example\n   * const message = new TypedMessage('/test/path', [\n   *   { type: 'i', value: 123 },\n   *   { type: 'd', value: 123.123 },\n   *   { type: 'h', value: 0xFFFFFFn },\n   *   { type: 'T', value: null },\n   * ])\n   */\n  constructor(address, args) {\n    /**\n     * @type {number} offset\n     * @private\n     */\n    this.offset = 0\n    /** @type {string} address */\n    this.address = ''\n    /** @type {string} types */\n    this.types = ''\n    /** @type {MessageArgValue[]} args */\n    this.args = []\n\n    if (!isUndefined(address)) {\n      if (!(isString(address) || isArray(address))) {\n        throw new Error('OSC Message constructor first argument (address) must be a string or array')\n      }\n      this.address = prepareAddress(address)\n    }\n\n    if (!isUndefined(args)) {\n      if (!isArray(args)) {\n        throw new Error('OSC Message constructor second argument (args) must be an array')\n      }\n      args.forEach((item) => this.add(item.type, item.value))\n    }\n  }\n\n  /**\n   * Add an OSC Atomic Data Type to the list of elements\n   * @param {MessageArgType} type\n   * @param {MessageArgValue} item\n   */\n  add(type, item) {\n    if (isUndefined(type)) {\n      throw new Error('OSC Message needs a valid OSC Atomic Data Type')\n    }\n\n    if (type === 'N') {\n      this.args.push(VALUE_NONE)\n    } else if (type === 'T') {\n      this.args.push(VALUE_TRUE)\n    } else if (type === 'F') {\n      this.args.push(VALUE_FALSE)\n    } else if (type === 'I') {\n      this.args.push(VALUE_INFINITY)\n    } else {\n      this.args.push(item)\n    }\n\n    this.types += type\n  }\n\n  /**\n   * Interpret the Message as packed binary data\n   * @return {Uint8Array} Packed binary data\n   */\n  pack() {\n    if (this.address.length === 0 || this.address[0] !== '/') {\n      throw new Error('OSC Message has an invalid address')\n    }\n\n    const encoder = new Helper()\n\n    // OSC Address Pattern and Type string\n    encoder.add(new AtomicString(this.address))\n    encoder.add(new AtomicString(`,${this.types}`))\n\n    // followed by zero or more OSC Arguments\n    if (this.args.length > 0) {\n      let argument\n\n      if (this.args.length > this.types.length) {\n        throw new Error('OSC Message argument and type tag mismatch')\n      }\n\n      this.args.forEach((value, index) => {\n        const type = this.types[index]\n        if (type === 'i') {\n          argument = new AtomicInt32(value)\n        } else if (type === 'h') {\n          argument = new AtomicInt64(value)\n        } else if (type === 't') {\n          argument = new AtomicUInt64(value)\n        } else if (type === 'f') {\n          argument = new AtomicFloat32(value)\n        } else if (type === 'd') {\n          argument = new AtomicFloat64(value)\n        } else if (type === 's') {\n          argument = new AtomicString(value)\n        } else if (type === 'b') {\n          argument = new AtomicBlob(value)\n        } else if (type === 'T') {\n          argument = VALUE_TRUE\n        } else if (type === 'F') {\n          argument = VALUE_FALSE\n        } else if (type === 'N') {\n          argument = VALUE_NONE\n        } else if (type === 'I') {\n          argument = VALUE_INFINITY\n        } else {\n          throw new Error('OSC Message found unknown argument type')\n        }\n\n        encoder.add(argument)\n      })\n    }\n\n    return encoder.merge()\n  }\n\n  /**\n   * Unpack binary data to read a Message\n   * @param {DataView} dataView The DataView holding the binary representation of a Message\n   * @param {number} [initialOffset=0] Offset of DataView before unpacking\n   * @return {number} Offset after unpacking\n   */\n  unpack(dataView, initialOffset = 0) {\n    if (!(dataView instanceof DataView)) {\n      throw new Error('OSC Message expects an instance of type DataView.')\n    }\n\n    // read address pattern\n    const address = new AtomicString()\n    address.unpack(dataView, initialOffset)\n\n    // read type string\n    const types = new AtomicString()\n    types.unpack(dataView, address.offset)\n\n    if (address.value.length === 0 || address.value[0] !== '/') {\n      throw new Error('OSC Message found malformed or missing address string')\n    }\n\n    if (types.value.length === 0 && types.value[0] !== ',') {\n      throw new Error('OSC Message found malformed or missing type string')\n    }\n\n    let { offset } = types\n    let next\n    let type\n\n    const args = []\n\n    // read message arguments (OSC Atomic Data Types)\n    for (let i = 1; i < types.value.length; i += 1) {\n      type = types.value[i]\n      next = null\n\n      if (type === 'i') {\n        next = new AtomicInt32()\n      } else if (type === 'h') {\n        next = new AtomicInt64()\n      } else if (type === 't') {\n        next = new AtomicUInt64()\n      } else if (type === 'f') {\n        next = new AtomicFloat32()\n      } else if (type === 'd') {\n        next = new AtomicFloat64()\n      } else if (type === 's') {\n        next = new AtomicString()\n      } else if (type === 'b') {\n        next = new AtomicBlob()\n      } else if (type === 'T') {\n        args.push(VALUE_TRUE)\n      } else if (type === 'F') {\n        args.push(VALUE_FALSE)\n      } else if (type === 'N') {\n        args.push(VALUE_NONE)\n      } else if (type === 'I') {\n        args.push(VALUE_INFINITY)\n      } else {\n        throw new Error('OSC Message found unsupported argument type')\n      }\n\n      if (next) {\n        offset = next.unpack(dataView, offset)\n        args.push(next.value)\n      }\n    }\n\n    this.offset = offset\n    this.address = address.value\n    this.types = types.value\n    this.args = args\n\n    return this.offset\n  }\n}\n\n/**\n * An OSC message consists of an OSC Address Pattern followed\n * by an OSC Type Tag String followed by zero or more OSC Arguments\n */\nexport default class Message extends TypedMessage {\n  /**\n   * Create a Message instance\n   * @param {string[]|string} address Address\n   * @param {...MessageArgValue} args OSC Atomic Data Types\n   *\n   * @example\n   * const message = new Message(['test', 'path'], 50, 100.52, 'test')\n   *\n   * @example\n   * const message = new Message('/test/path', 51.2)\n   */\n  constructor(address, ...args) {\n    let oscArgs\n    if (args.length > 0) {\n      if (args[0] instanceof Array) {\n        oscArgs = args.shift()\n      }\n    }\n\n    super(address, oscArgs)\n\n    if (args.length > 0) {\n      this.types = args.map((item) => typeTag(item)).join('')\n      this.args = args\n    }\n  }\n\n  /**\n   * Add an OSC Atomic Data Type to the list of elements\n   * @param {MessageArgValue} item\n   */\n  add(item) {\n    super.add(typeTag(item), item)\n  }\n}\n","import EncodeHelper from './common/helpers'\nimport { isArray, isInt } from './common/utils'\n\nimport AtomicInt32 from './atomic/int32'\nimport AtomicString from './atomic/string'\nimport AtomicTimetag from './atomic/timetag'\nimport Message from './message'\n\n/** OSC Bundle string */\nexport const BUNDLE_TAG = '#bundle'\n\n/**\n * An OSC Bundle consist of a Timetag and one or many Bundle Elements.\n * The elements are either OSC Messages or more OSC Bundles\n */\nexport default class Bundle {\n  /**\n   * Create a Bundle instance\n   * @param {...*} args Timetag and elements. See examples for options\n   *\n   * @example\n   * const bundle = new Bundle(new Date() + 500)\n   *\n   * @example\n   * const message = new Message('/test/path', 51.2)\n   * const anotherBundle = new Bundle([message], Date.now() + 1500)\n   *\n   * @example\n   * const message = new Message('/test/path', 51.2)\n   * const anotherMessage = new Message('/test/message', 'test', 12)\n   * const anotherBundle = new Bundle(message, anotherMessage)\n   */\n  constructor(...args) {\n    /**\n     * @type {number} offset\n     * @private\n     */\n    this.offset = 0\n    /** @type {AtomicTimetag} timetag */\n    this.timetag = new AtomicTimetag()\n    /** @type {array} bundleElements */\n    this.bundleElements = []\n\n    if (args.length > 0) {\n      // first argument is an Date or js timestamp (number)\n      if (args[0] instanceof Date || isInt(args[0])) {\n        this.timetag = new AtomicTimetag(args[0])\n      } else if (isArray(args[0])) {\n        // first argument is an Array of Bundle elements\n        args[0].forEach((item) => {\n          this.add(item)\n        })\n\n        // second argument is an Date or js timestamp (number)\n        if (args.length > 1 && (args[1] instanceof Date || isInt(args[1]))) {\n          this.timetag = new AtomicTimetag(args[1])\n        }\n      } else {\n        // take all arguments as Bundle elements\n        args.forEach((item) => {\n          this.add(item)\n        })\n      }\n    }\n  }\n\n  /**\n   * Take a JavaScript timestamp to set the Bundle's timetag\n   * @param {number} ms JS timestamp in milliseconds\n   *\n   * @example\n   * const bundle = new Bundle()\n   * bundle.timestamp(Date.now() + 5000) // in 5 seconds\n   */\n  timestamp(ms) {\n    if (!isInt(ms)) {\n      throw new Error('OSC Bundle needs an integer for setting the timestamp')\n    }\n\n    this.timetag = new AtomicTimetag(ms)\n  }\n\n  /**\n   * Add a Message or Bundle to the list of elements\n   * @param {Bundle|Message} item\n   */\n  add(item) {\n    if (!(item instanceof Message || item instanceof Bundle)) {\n      throw new Error('OSC Bundle contains only Messages and Bundles')\n    }\n\n    this.bundleElements.push(item)\n  }\n\n  /**\n   * Interpret the Bundle as packed binary data\n   * @return {Uint8Array} Packed binary data\n   */\n  pack() {\n    const encoder = new EncodeHelper()\n\n    // an OSC Bundle consists of the OSC-string \"#bundle\"\n    encoder.add(new AtomicString(BUNDLE_TAG))\n\n    // followed by an OSC Time Tag\n    if (!this.timetag) {\n      this.timetag = new AtomicTimetag()\n    }\n\n    encoder.add(this.timetag)\n\n    // followed by zero or more OSC Bundle Elements\n    this.bundleElements.forEach((item) => {\n      encoder.add(new AtomicInt32(item.pack().byteLength))\n      encoder.add(item)\n    })\n\n    return encoder.merge()\n  }\n\n  /**\n   * Unpack binary data to read a Bundle\n   * @param {DataView} dataView The DataView holding the binary representation of a Bundle\n   * @param {number} [initialOffset=0] Offset of DataView before unpacking\n   * @return {number} Offset after unpacking\n   */\n  unpack(dataView, initialOffset = 0) {\n    if (!(dataView instanceof DataView)) {\n      throw new Error('OSC Bundle expects an instance of type DataView')\n    }\n\n    // read the beginning bundle string\n    const parentHead = new AtomicString()\n    parentHead.unpack(dataView, initialOffset)\n\n    if (parentHead.value !== BUNDLE_TAG) {\n      throw new Error('OSC Bundle does not contain a valid #bundle head')\n    }\n\n    // read the timetag\n    const timetag = new AtomicTimetag()\n    let offset = timetag.unpack(dataView, parentHead.offset)\n\n    // read the bundle elements\n    this.bundleElements = []\n\n    while (offset < dataView.byteLength) {\n      const head = new AtomicString()\n      const size = new AtomicInt32()\n\n      offset = size.unpack(dataView, offset)\n\n      // check if Packet is a Bundle or a Message\n      let item\n      head.unpack(dataView, offset)\n\n      if (head.value === BUNDLE_TAG) {\n        item = new Bundle()\n      } else {\n        item = new Message()\n      }\n\n      offset = item.unpack(dataView, offset)\n\n      this.bundleElements.push(item)\n    }\n\n    this.offset = offset\n    this.timetag = timetag\n\n    return this.offset\n  }\n}\n","import AtomicString from './atomic/string'\nimport Bundle, { BUNDLE_TAG } from './bundle'\nimport Message from './message'\n\n/**\n * The unit of transmission of OSC is an OSC Packet. The contents\n * of an OSC packet must be either an OSC Message or an OSC Bundle\n */\nexport default class Packet {\n  /**\n   * Create a Packet instance holding a Message or Bundle\n   * @param {Message|Bundle} [value] Initial Packet value\n   */\n  constructor(value) {\n    if (value && !(value instanceof Message || value instanceof Bundle)) {\n      throw new Error('OSC Packet value has to be Message or Bundle')\n    }\n\n    /** @type {Message|Bundle} value */\n    this.value = value\n    /**\n     * @type {number} offset\n     * @private\n     */\n    this.offset = 0\n  }\n\n  /**\n   * Packs the Packet value. This implementation is more like\n   * a wrapper due to OSC specifications, you could also skip the\n   * Packet and directly work with the Message or Bundle instance\n   * @return {Uint8Array} Packed binary data\n   *\n   * @example\n   * const message = new Message('/test/path', 21.5, 'test')\n   * const packet = new Packet(message)\n   * const packetBinary = packet.pack() // then send it via udp etc.\n   *\n   * // or skip the Packet for convenience\n   * const messageBinary = message.pack()\n   */\n  pack() {\n    if (!this.value) {\n      throw new Error('OSC Packet can not be encoded with empty body')\n    }\n\n    return this.value.pack()\n  }\n\n  /**\n   * Unpack binary data from DataView to read Messages or Bundles\n   * @param {DataView} dataView The DataView holding a binary representation of a Packet\n   * @param {number} [initialOffset=0] Offset of DataView before unpacking\n   * @return {number} Offset after unpacking\n   */\n  unpack(dataView, initialOffset = 0) {\n    if (!(dataView instanceof DataView)) {\n      throw new Error('OSC Packet expects an instance of type DataView')\n    }\n\n    if (dataView.byteLength % 4 !== 0) {\n      throw new Error('OSC Packet byteLength has to be a multiple of four')\n    }\n\n    const head = new AtomicString()\n    head.unpack(dataView, initialOffset)\n\n    let item\n\n    // check if Packet is a Bundle or a Message\n    if (head.value === BUNDLE_TAG) {\n      item = new Bundle()\n    } else {\n      item = new Message()\n    }\n\n    item.unpack(dataView, initialOffset)\n\n    this.offset = item.offset\n    this.value = item\n\n    return this.offset\n  }\n}\n","import {\n  dataView,\n  isArray,\n  isFunction,\n  isInt,\n  isString,\n} from './common/utils'\n\nimport {\n  prepareAddress,\n  prepareRegExPattern,\n} from './common/helpers'\n\nimport Bundle from './bundle'\nimport Message from './message'\nimport Packet from './packet'\n\n/**\n * Default options\n * @private\n */\nconst defaultOptions = {\n  discardLateMessages: false,\n}\n\n/**\n * EventHandler to notify listeners on matching OSC messages and\n * status changes of plugins\n */\nexport default class EventHandler {\n  /**\n   * Create an EventHandler instance\n   * @param {object} options Custom options\n   */\n  constructor(options) {\n    /**\n     * @type {object} options\n     * @private\n     */\n    this.options = { ...defaultOptions, ...options }\n    /**\n     * @type {array} addressHandlers\n     * @private\n     */\n    this.addressHandlers = []\n    /**\n     * @type {object} eventHandlers\n     * @private\n     */\n    this.eventHandlers = {\n      open: [],\n      error: [],\n      close: [],\n    }\n    /**\n     * @type {number} uuid\n     * @private\n     */\n    this.uuid = 0\n  }\n\n  /**\n   * Internally used method to dispatch OSC Packets. Extracts\n   * given Timetags and dispatches them accordingly\n   * @param {Packet} packet\n   * @param {*} [rinfo] Remote address info\n   * @return {boolean} Success state\n   * @private\n   */\n  dispatch(packet, rinfo) {\n    if (!(packet instanceof Packet)) {\n      throw new Error('OSC EventHander dispatch() accepts only arguments of type Packet')\n    }\n\n    if (!packet.value) {\n      throw new Error('OSC EventHander dispatch() can\\'t read empty Packets')\n    }\n\n    if (packet.value instanceof Bundle) {\n      const bundle = packet.value\n\n      return bundle.bundleElements.forEach((bundleItem) => {\n        if (bundleItem instanceof Bundle) {\n          if (bundle.timetag.value.timestamp() < bundleItem.timetag.value.timestamp()) {\n            throw new Error('OSC Bundle timestamp is older than the timestamp of enclosed Bundles')\n          }\n          return this.dispatch(new Packet(bundleItem))\n        } else if (bundleItem instanceof Message) {\n          const message = bundleItem\n          return this.notify(\n            message.address,\n            message,\n            bundle.timetag.value.timestamp(),\n            rinfo,\n          )\n        }\n\n        throw new Error('OSC EventHander dispatch() can\\'t dispatch unknown Packet value')\n      })\n    } else if (packet.value instanceof Message) {\n      const message = packet.value\n      return this.notify(message.address, message, 0, rinfo)\n    }\n\n    throw new Error('OSC EventHander dispatch() can\\'t dispatch unknown Packet value')\n  }\n\n  /**\n   * Internally used method to invoke listener callbacks. Uses regular\n   * expression pattern matching for OSC addresses\n   * @param {string} name OSC address or event name\n   * @param {*} [data] The data of the event\n   * @param {*} [rinfo] Remote address info\n   * @return {boolean} Success state\n   * @private\n   */\n  call(name, data, rinfo) {\n    let success = false\n\n    // call event handlers\n    if (isString(name) && name in this.eventHandlers) {\n      this.eventHandlers[name].forEach((handler) => {\n        handler.callback(data, rinfo)\n        success = true\n      })\n\n      return success\n    }\n\n    // call address handlers\n    const handlerKeys = Object.keys(this.addressHandlers)\n    const handlers = this.addressHandlers\n\n    handlerKeys.forEach((key) => {\n      let foundMatch = false\n\n      const regex = new RegExp(prepareRegExPattern(prepareAddress(name)), 'g')\n      const test = regex.test(key)\n\n      // found a matching address in our callback handlers\n      if (test && key.length === regex.lastIndex) {\n        foundMatch = true\n      }\n\n      if (!foundMatch) {\n        // try matching address from callback handlers (when given)\n        const reverseRegex = new RegExp(prepareRegExPattern(prepareAddress(key)), 'g')\n        const reverseTest = reverseRegex.test(name)\n\n        if (reverseTest && name.length === reverseRegex.lastIndex) {\n          foundMatch = true\n        }\n      }\n\n      if (foundMatch) {\n        handlers[key].forEach((handler) => {\n          handler.callback(data, rinfo)\n          success = true\n        })\n      }\n    })\n\n    return success\n  }\n\n  /**\n   * Notify the EventHandler of incoming OSC messages or status\n   * changes (*open*, *close*, *error*). Handles OSC address patterns\n   * and executes timed messages. Use binary arrays when\n   * handling directly incoming network data. Packet's or Messages can\n   * also be used\n   * @param {...*} args\n   * The OSC address pattern / event name as string}. For convenience and\n   * Plugin API communication you can also use Message or Packet instances\n   * or ArrayBuffer, Buffer instances (low-level access). The latter will\n   * automatically be unpacked\n   * When using a string you can also pass on data as a second argument\n   * (any type). All regarding listeners will be notified with this data.\n   * As a third argument you can define a javascript timestamp (number or\n   * Date instance) for timed notification of the listeners.\n   * @return {boolean} Success state of notification\n   *\n   * @example\n   * const socket = dgram.createSocket('udp4')\n   * socket.on('message', (message) => {\n   *   this.notify(message)\n   * })\n   *\n   * @example\n   * this.notify('error', error.message)\n   *\n   * @example\n   * const message = new OSC.Message('/test/path', 55)\n   * this.notify(message)\n   *\n   * @example\n   * const message = new OSC.Message('/test/path', 55)\n   * // override timestamp\n   * this.notify(message.address, message, Date.now() + 5000)\n   */\n  notify(...args) {\n    if (args.length === 0) {\n      throw new Error('OSC EventHandler can not be called without any argument')\n    }\n\n    try {\n      // check for incoming dispatchable OSC data\n      if (args[0] instanceof Packet) {\n        return this.dispatch(args[0], args[1])\n      } else if (args[0] instanceof Bundle || args[0] instanceof Message) {\n        return this.dispatch(new Packet(args[0]), args[1])\n      } else if (!isString(args[0])) {\n        const packet = new Packet()\n        packet.unpack(dataView(args[0]))\n        return this.dispatch(packet, args[1])\n      }\n\n      const name = args[0]\n\n      // data argument\n      let data = null\n\n      if (args.length > 1) {\n        data = args[1]\n      }\n\n      // timestamp argument\n      let timestamp = null\n\n      if (args.length > 2) {\n        if (isInt(args[2])) {\n          timestamp = args[2]\n        } else if (args[2] instanceof Date) {\n          timestamp = args[2].getTime()\n        } else {\n          throw new Error('OSC EventHandler timestamp has to be a number or Date')\n        }\n      }\n\n      // remote address info\n      let rinfo = null\n\n      if (args.length >= 3) {\n        rinfo = args[3]\n      }\n\n      // notify now or later\n      if (timestamp) {\n        const now = Date.now()\n\n        // is message outdated?\n        if (now > timestamp) {\n          if (!this.options.discardLateMessages) {\n            return this.call(name, data, rinfo)\n          }\n        }\n\n        // notify later\n        const that = this\n\n        setTimeout(() => {\n          that.call(name, data, rinfo)\n        }, timestamp - now)\n\n        return true\n      }\n\n      return this.call(name, data, rinfo)\n    } catch (error) {\n      this.notify('error', error)\n      return false\n    }\n  }\n\n  /**\n   * Subscribe to a new address or event you want to listen to\n   * @param {string} name The OSC address or event name\n   * @param {function} callback Callback function on notification\n   * @return {number} Subscription identifier (needed to unsubscribe)\n   */\n  on(name, callback) {\n    if (!(isString(name) || isArray(name))) {\n      throw new Error('OSC EventHandler accepts only strings or arrays for address patterns')\n    }\n\n    if (!isFunction(callback)) {\n      throw new Error('OSC EventHandler callback has to be a function')\n    }\n\n    // get next id\n    this.uuid += 1\n\n    // prepare handler\n    const handler = {\n      id: this.uuid,\n      callback,\n    }\n\n    // register event listener\n    if (isString(name) && name in this.eventHandlers) {\n      this.eventHandlers[name].push(handler)\n      return this.uuid\n    }\n\n    // register address listener\n    const address = prepareAddress(name)\n\n    if (!(address in this.addressHandlers)) {\n      this.addressHandlers[address] = []\n    }\n\n    this.addressHandlers[address].push(handler)\n\n    return this.uuid\n  }\n\n  /**\n   * Unsubscribe listener from event notification or address handler\n   * @param {string} name The OSC address or event name\n   * @param {number} subscriptionId Subscription id to identify the handler\n   * @return {boolean} Success state\n   */\n  off(name, subscriptionId) {\n    if (!(isString(name) || isArray(name))) {\n      throw new Error('OSC EventHandler accepts only strings or arrays for address patterns')\n    }\n\n    if (!isInt(subscriptionId)) {\n      throw new Error('OSC EventHandler subscription id has to be a number')\n    }\n\n    let key\n    let haystack\n\n    // event or address listener\n    if (isString(name) && name in this.eventHandlers) {\n      key = name\n      haystack = this.eventHandlers\n    } else {\n      key = prepareAddress(name)\n      haystack = this.addressHandlers\n    }\n\n    // remove the entry\n    if (key in haystack) {\n      return haystack[key].some((item, index) => {\n        if (item.id === subscriptionId) {\n          haystack[key].splice(index, 1)\n          return true\n        }\n\n        return false\n      })\n    }\n\n    return false\n  }\n}\n","// /**\n//  @constructor\n//  @abstract\n//  */\n// const Plugin = () => {\n//   if (this.constructor === Plugin) {\n//   }\n// }\n\n// /**\n// @abstract\n// */\n// Plugin.prototype.close = () => {\n//   throw new Error('Abstract method!')\n// }\n\nexport default class Plugin {\n  constructor() {\n    if (this.constructor === Plugin) {\n      throw new Error('Plugin is an abstract class. Please create or use an implementation!')\n    }\n  }\n\n  /**\n   * Returns the current status of the connection\n   * @return {number} Status ID\n   */\n  status() {\n    throw new Error('Abstract method!')\n  }\n\n  /**\n   * Open socket connection. Specifics depend on implementation.\n   * @param {object} [customOptions] Custom options. See implementation specifics.\n   */\n  // eslint-disable-next-line no-unused-vars\n  open(customOptions = {}) {\n    throw new Error('Abstract method!')\n  }\n\n  /**\n   * Close socket connection and anything else used in the implementation.\n   */\n  close() {\n    throw new Error('Abstract method!')\n  }\n\n  /**\n   * Send an OSC Packet, Bundle or Message. Use options here for\n   * custom receiver, otherwise the global options will be taken\n   * @param {Uint8Array} binary Binary representation of OSC Packet\n   * @param {object} [customOptions] Custom options. Specifics depend on implementation.\n   */\n  // eslint-disable-next-line no-unused-vars\n  send(binary, customOptions = {}) {\n    throw new Error('Abstract method!')\n  }\n}\n","import dgram from 'dgram'\n\nimport Plugin from './plugin'\n\n/**\n * Status flags\n * @private\n */\nconst STATUS = {\n  IS_NOT_INITIALIZED: -1,\n  IS_CONNECTING: 0,\n  IS_OPEN: 1,\n  IS_CLOSING: 2,\n  IS_CLOSED: 3,\n}\n\n/**\n * Default options for open method\n * @private\n */\nconst defaultOpenOptions = {\n  host: 'localhost',\n  port: 41234,\n  exclusive: false,\n}\n\n/**\n * Default options for send method\n * @private\n */\nconst defaultSendOptions = {\n  host: 'localhost',\n  port: 41235,\n}\n\n/**\n * Default options\n * @private\n */\nconst defaultOptions = {\n  type: 'udp4',\n  open: defaultOpenOptions,\n  send: defaultSendOptions,\n}\n\n/**\n * Helper method to merge nested objects\n * @private\n */\nfunction mergeOptions(base, custom) {\n  return {\n    ...defaultOptions,\n    ...base,\n    ...custom,\n    open: { ...defaultOptions.open, ...base.open, ...custom.open },\n    send: { ...defaultOptions.send, ...base.send, ...custom.send },\n  }\n}\n\n/**\n * OSC plugin for simple OSC messaging via udp client\n * and udp server\n */\nexport default class DatagramPlugin extends Plugin {\n  /**\n   * Create an OSC Plugin instance with given options. Defaults to\n   * localhost:41234 for server and localhost:41235 for client messaging\n   * @param {object} [options] Custom options\n   * @param {string} [options.type='udp4'] 'udp4' or 'udp6'\n   * @param {string} [options.open.host='localhost'] Hostname of udp server to bind to\n   * @param {number} [options.open.port=41234] Port of udp server to bind to\n   * @param {boolean} [options.open.exclusive=false] Exclusive flag\n   * @param {string} [options.send.host='localhost'] Hostname of udp client for messaging\n   * @param {number} [options.send.port=41235] Port of udp client for messaging\n   *\n   * @example\n   * const plugin = new OSC.DatagramPlugin({ send: { port: 9912 } })\n   * const osc = new OSC({ plugin: plugin })\n   */\n  constructor(options = {}) {\n    super()\n\n    // `dgram` gets replaced with an undefined value in builds targeting\n    // browser environments\n    if (!dgram) {\n      throw new Error('DatagramPlugin can not be used in browser context')\n    }\n\n    /**\n     * @type {object} options\n     * @private\n     */\n    this.options = mergeOptions({}, options)\n\n    /**\n     * @type {object} socket\n     * @private\n     */\n    this.socket = dgram.createSocket(this.options.type)\n    /**\n     * @type {number} socketStatus\n     * @private\n     */\n    this.socketStatus = STATUS.IS_NOT_INITIALIZED\n\n    // register events\n    this.socket.on('message', (message, rinfo) => {\n      this.notify(message, rinfo)\n    })\n\n    this.socket.on('error', (error) => {\n      this.notify('error', error)\n    })\n\n    /**\n     * @type {function} notify\n     * @private\n     */\n    this.notify = () => {}\n  }\n\n  /**\n   * Internal method to hook into osc library's\n   * EventHandler notify method\n   * @param {function} fn Notify callback\n   * @private\n   */\n  registerNotify(fn) {\n    this.notify = fn\n  }\n\n  /**\n   * Returns the current status of the connection\n   * @return {number} Status ID\n   */\n  status() {\n    return this.socketStatus\n  }\n\n  /**\n   * Bind a udp socket to a hostname and port\n   * @param {object} [customOptions] Custom options\n   * @param {string} [customOptions.host='localhost'] Hostname of udp server to bind to\n   * @param {number} [customOptions.port=41234] Port of udp server to bind to\n   * @param {boolean} [customOptions.exclusive=false] Exclusive flag\n   */\n  open(customOptions = {}) {\n    const options = { ...this.options.open, ...customOptions }\n    const { port, exclusive } = options\n\n    this.socketStatus = STATUS.IS_CONNECTING\n\n    this.socket.bind({\n      address: options.host,\n      port,\n      exclusive,\n    }, () => {\n      this.socketStatus = STATUS.IS_OPEN\n      this.notify('open')\n    })\n  }\n\n  /**\n   * Close udp socket\n   */\n  close() {\n    this.socketStatus = STATUS.IS_CLOSING\n\n    this.socket.close(() => {\n      this.socketStatus = STATUS.IS_CLOSED\n      this.notify('close')\n    })\n  }\n\n  /**\n   * Send an OSC Packet, Bundle or Message. Use options here for\n   * custom port and hostname, otherwise the global options will\n   * be taken\n   * @param {Uint8Array} binary Binary representation of OSC Packet\n   * @param {object} [customOptions] Custom options for udp socket\n   * @param {string} [customOptions.host] Hostname of udp client\n   * @param {number} [customOptions.port] Port of udp client\n   */\n  send(binary, customOptions = {}) {\n    const options = { ...this.options.send, ...customOptions }\n    const { port, host } = options\n\n    this.socket.send(Buffer.from(binary), 0, binary.byteLength, port, host)\n  }\n}\n","// This file gets used instead of the `ws` package during rollup builds\n// targeting browser environments.\n/* eslint-disable no-undef */\n/* eslint-disable no-restricted-globals */\nfunction fillWs() {\n  if (typeof WebSocket !== 'undefined') {\n    return WebSocket\n  } else if (typeof MozWebSocket !== 'undefined') {\n    return MozWebSocket\n  } else if (typeof global !== 'undefined') {\n    return global.WebSocket || global.MozWebSocket\n  } else if (typeof window !== 'undefined') {\n    return window.WebSocket || window.MozWebSocket\n  } else if (typeof self !== 'undefined') {\n    return self.WebSocket || self.MozWebSocket\n  }\n  return undefined\n}\n/* eslint-enable no-undef */\n/* eslint-enable no-restricted-globals */\n\nconst ws = fillWs()\n\n/**\n * Do not export server for browser environments.\n * @private\n */\nexport const WebSocketServer = undefined\n\n/**\n * Return WebSocket client for browser environments.\n * @private\n */\nexport default ws\n","import dgram from 'dgram'\nimport { WebSocketServer } from 'ws'\n\nimport Plugin from './plugin'\n\n/**\n * Status flags\n * @private\n */\nconst STATUS = {\n  IS_NOT_INITIALIZED: -1,\n  IS_CONNECTING: 0,\n  IS_OPEN: 1,\n  IS_CLOSING: 2,\n  IS_CLOSED: 3,\n}\n\n/**\n * Default options\n * @private\n */\nconst defaultOptions = {\n  udpServer: {\n    host: 'localhost',\n    port: 41234,\n    exclusive: false,\n  },\n  udpClient: {\n    host: 'localhost',\n    port: 41235,\n  },\n  wsServer: {\n    host: 'localhost',\n    port: 8080,\n  },\n  receiver: 'ws',\n}\n\n/**\n * Helper method to merge nested objects\n * @private\n */\nfunction mergeOptions(base, custom) {\n  return {\n    ...defaultOptions,\n    ...base,\n    ...custom,\n    udpServer: { ...defaultOptions.udpServer, ...base.udpServer, ...custom.udpServer },\n    udpClient: { ...defaultOptions.udpClient, ...base.udpClient, ...custom.udpClient },\n    wsServer: { ...defaultOptions.wsServer, ...base.wsServer, ...custom.wsServer },\n  }\n}\n\n/**\n * OSC plugin for setting up communication between a Websocket\n * client and a udp client with a bridge inbetween\n */\nexport default class BridgePlugin extends Plugin {\n  /**\n   * Create an OSC Bridge instance with given options. Defaults to\n   * localhost:41234 for udp server, localhost:41235 for udp client and\n   * localhost:8080 for Websocket server\n   * @param {object} [options] Custom options\n   * @param {string} [options.udpServer.host='localhost'] Hostname of udp server to bind to\n   * @param {number} [options.udpServer.port=41234] Port of udp server to bind to\n   * @param {boolean} [options.udpServer.exclusive=false] Exclusive flag\n   * @param {string} [options.udpClient.host='localhost'] Hostname of udp client for messaging\n   * @param {number} [options.udpClient.port=41235] Port of udp client for messaging\n   * @param {string} [options.wsServer.host='localhost'] Hostname of Websocket server\n   * @param {number} [options.wsServer.port=8080] Port of Websocket server\n   * @param {http.Server|https.Server} [options.wsServer.server] Use existing Node.js HTTP/S server\n   * @param {string} [options.receiver='ws'] Where messages sent via 'send' method will be\n   * delivered to, 'ws' for Websocket clients, 'udp' for udp client\n   *\n   * @example\n   * const plugin = new OSC.BridgePlugin({ wsServer: { port: 9912 } })\n   * const osc = new OSC({ plugin: plugin })\n   *\n   * @example <caption>Using an existing HTTP server</caption>\n   * const http = require('http')\n   * const httpServer = http.createServer();\n   * const plugin = new OSC.BridgePlugin({ wsServer: { server: httpServer } })\n   * const osc = new OSC({ plugin: plugin })\n   */\n  constructor(options = {}) {\n    super()\n\n    // `dgram` and `WebSocketServer` get replaced with an undefined value in\n    // builds targeting browser environments\n    if (!dgram || !WebSocketServer) {\n      throw new Error('BridgePlugin can not be used in browser context')\n    }\n\n    /** @type {object} options\n     * @private\n     */\n    this.options = mergeOptions({}, options)\n\n    /**\n     * @type {object} websocket\n     * @private\n     */\n    this.websocket = null\n\n    /**\n     * @type {object} socket\n     * @private\n     */\n    this.socket = dgram.createSocket('udp4')\n    /**\n     * @type {number} socketStatus\n     * @private\n     */\n    this.socketStatus = STATUS.IS_NOT_INITIALIZED\n\n    // register udp events\n    this.socket.on('message', (message) => {\n      this.send(message, { receiver: 'ws' })\n      this.notify(message.buffer)\n    })\n\n    this.socket.on('error', (error) => {\n      this.notify('error', error)\n    })\n\n    /**\n     * @type {function} notify\n     * @private\n     */\n    this.notify = () => {}\n  }\n\n  /**\n   * Internal method to hook into osc library's\n   * EventHandler notify method\n   * @param {function} fn Notify callback\n   * @private\n   */\n  registerNotify(fn) {\n    this.notify = fn\n  }\n\n  /**\n   * Returns the current status of the connection\n   * @return {number} Status ID\n   */\n  status() {\n    return this.socketStatus\n  }\n\n  /**\n   * Bind a udp socket to a hostname and port\n   * @param {object} [customOptions] Custom options\n   * @param {string} [customOptions.host='localhost'] Hostname of udp server to bind to\n   * @param {number} [customOptions.port=41234] Port of udp server to bind to\n   * @param {boolean} [customOptions.exclusive=false] Exclusive flag\n   */\n  open(customOptions = {}) {\n    const options = mergeOptions(this.options, customOptions)\n\n    this.socketStatus = STATUS.IS_CONNECTING\n\n    // bind udp server\n    this.socket.bind({\n      address: options.udpServer.host,\n      port: options.udpServer.port,\n      exclusive: options.udpServer.exclusive,\n    }, () => {\n      let wsServerOptions = {}\n      if (options.wsServer.server) {\n        wsServerOptions.server = options.wsServer.server\n      } else {\n        wsServerOptions = options.wsServer\n      }\n\n      // bind Websocket server\n      this.websocket = new WebSocketServer(wsServerOptions)\n      this.websocket.binaryType = 'arraybuffer'\n\n      // register Websocket events\n      this.websocket.on('listening', () => {\n        this.socketStatus = STATUS.IS_OPEN\n        this.notify('open')\n      })\n\n      this.websocket.on('error', (error) => {\n        this.notify('error', error)\n      })\n\n      this.websocket.on('connection', (client) => {\n        client.on('message', (message, rinfo) => {\n          this.send(message, { receiver: 'udp' })\n          this.notify(new Uint8Array(message), rinfo)\n        })\n      })\n    })\n  }\n\n  /**\n   * Close udp socket and Websocket server\n   */\n  close() {\n    this.socketStatus = STATUS.IS_CLOSING\n\n    // close udp socket\n    this.socket.close(() => {\n      // close Websocket\n      this.websocket.close(() => {\n        this.socketStatus = STATUS.IS_CLOSED\n        this.notify('close')\n      })\n    })\n  }\n\n  /**\n   * Send an OSC Packet, Bundle or Message. Use options here for\n   * custom receiver, otherwise the global options will be taken\n   * @param {Uint8Array} binary Binary representation of OSC Packet\n   * @param {object} [customOptions] Custom options\n   * @param {string} [customOptions.udpClient.host='localhost'] Hostname of udp client for messaging\n   * @param {number} [customOptions.udpClient.port=41235] Port of udp client for messaging\n   * @param {string} [customOptions.receiver='ws'] Messages will be delivered to Websocket ('ws')\n   * clients or udp client ('udp')\n   */\n  send(binary, customOptions = {}) {\n    const options = mergeOptions(this.options, customOptions)\n    const { receiver } = options\n\n    if (receiver === 'udp') {\n      // send data to udp client\n      const data = binary instanceof Buffer ? binary : Buffer.from(binary)\n      this.socket.send(\n        data,\n        0,\n        data.byteLength,\n        options.udpClient.port,\n        options.udpClient.host,\n      )\n    } else if (receiver === 'ws') {\n      // send data to all Websocket clients\n      this.websocket.clients.forEach((client) => {\n        client.send(binary, { binary: true })\n      })\n    } else {\n      throw new Error('BridgePlugin can not send message to unknown receiver')\n    }\n  }\n}\n","import WebSocket from 'ws'\n\nimport Plugin from './plugin'\n\n/**\n * Status flags\n * @private\n */\nconst STATUS = {\n  IS_NOT_INITIALIZED: -1,\n  IS_CONNECTING: 0,\n  IS_OPEN: 1,\n  IS_CLOSING: 2,\n  IS_CLOSED: 3,\n}\n\n/**\n * Default options\n * @private\n */\nconst defaultOptions = {\n  host: 'localhost',\n  port: 8080,\n  secure: false,\n  protocol: [],\n}\n\n/**\n * OSC plugin for a Websocket client running in node or browser context\n */\nexport default class WebsocketClientPlugin extends Plugin {\n  /**\n   * Create an OSC WebsocketClientPlugin instance with given options.\n   * Defaults to *localhost:8080* for connecting to a Websocket server\n   * @param {object} [options] Custom options\n   * @param {string} [options.host='localhost'] Hostname of Websocket server\n   * @param {number} [options.port=8080] Port of Websocket server\n   * @param {boolean} [options.secure=false] Use wss:// for secure connections\n   * @param {string|string[]} [options.protocol=''] Subprotocol of Websocket server\n   *\n   * @example\n   * const plugin = new OSC.WebsocketClientPlugin({ port: 9912 })\n   * const osc = new OSC({ plugin: plugin })\n   */\n  constructor(options) {\n    super()\n\n    if (!WebSocket) {\n      throw new Error('WebsocketClientPlugin can\\'t find a WebSocket class')\n    }\n\n    /**\n     * @type {object} options\n     * @private\n     */\n    this.options = { ...defaultOptions, ...options }\n\n    /**\n     * @type {object} socket\n     * @private\n     */\n    this.socket = null\n    /**\n     * @type {number} socketStatus\n     * @private\n     */\n    this.socketStatus = STATUS.IS_NOT_INITIALIZED\n\n    /**\n     * @type {function} notify\n     * @private\n     */\n    this.notify = () => {}\n  }\n\n  /**\n   * Internal method to hook into osc library's\n   * EventHandler notify method\n   * @param {function} fn Notify callback\n   * @private\n   */\n  registerNotify(fn) {\n    this.notify = fn\n  }\n\n  /**\n   * Returns the current status of the connection\n   * @return {number} Status identifier\n   */\n  status() {\n    return this.socketStatus\n  }\n\n  /**\n   * Connect to a Websocket server. Defaults to global options\n   * @param {object} [customOptions] Custom options\n   * @param {string} [customOptions.host] Hostname of Websocket server\n   * @param {number} [customOptions.port] Port of Websocket server\n   * @param {boolean} [customOptions.secure] Use wss:// for secure connections\n   * @param {string|string[]} [options.protocol] Subprotocol of Websocket server\n   */\n  open(customOptions = {}) {\n    const options = { ...this.options, ...customOptions }\n    const {\n      port, host, secure, protocol,\n    } = options\n\n    // close socket when already given\n    if (this.socket) {\n      this.close()\n    }\n\n    // create websocket client\n    const scheme = secure ? 'wss' : 'ws'\n    const rinfo = {\n      address: host,\n      family: scheme,\n      port,\n      size: 0,\n    }\n\n    this.socket = new WebSocket(`${scheme}://${host}:${port}`, protocol)\n    this.socket.binaryType = 'arraybuffer'\n    this.socketStatus = STATUS.IS_CONNECTING\n\n    // register events\n    this.socket.onopen = () => {\n      this.socketStatus = STATUS.IS_OPEN\n      this.notify('open')\n    }\n\n    this.socket.onclose = () => {\n      this.socketStatus = STATUS.IS_CLOSED\n      this.notify('close')\n    }\n\n    this.socket.onerror = (error) => {\n      this.notify('error', error)\n    }\n\n    this.socket.onmessage = (message) => {\n      this.notify(message.data, rinfo)\n    }\n  }\n\n  /**\n   * Close Websocket\n   */\n  close() {\n    this.socketStatus = STATUS.IS_CLOSING\n    this.socket.close()\n  }\n\n  /**\n   * Send an OSC Packet, Bundle or Message to Websocket server\n   * @param {Uint8Array} binary Binary representation of OSC Packet\n   */\n  send(binary) {\n    this.socket.send(binary)\n  }\n}\n","import { WebSocketServer } from 'ws'\n\nimport Plugin from './plugin'\n\n/**\n * Status flags\n * @private\n */\nconst STATUS = {\n  IS_NOT_INITIALIZED: -1,\n  IS_CONNECTING: 0,\n  IS_OPEN: 1,\n  IS_CLOSING: 2,\n  IS_CLOSED: 3,\n}\n\n/**\n * Default options\n * @private\n */\nconst defaultOptions = {\n  host: 'localhost',\n  port: 8080,\n}\n\n/**\n * This will import the types for JSDoc/Type declarations without\n * impacting the runtime\n * @typedef {import('http').Server|import('https').Server} Server\n */\n\n/**\n * OSC plugin for a Websocket client running in node or browser context\n */\nexport default class WebsocketServerPlugin extends Plugin {\n  /**\n   * Create an OSC WebsocketServerPlugin instance with given options.\n   * Defaults to *localhost:8080* for the Websocket server\n   * @param {object} [options] Custom options\n   * @param {string} [options.host='localhost'] Hostname of Websocket server\n   * @param {number} [options.port=8080] Port of Websocket server\n   * @param {Server} [options.server] Use existing Node.js HTTP/S server\n   *\n   * @example\n   * const plugin = new OSC.WebsocketServerPlugin({ port: 9912 })\n   * const osc = new OSC({ plugin: plugin })\n   *\n   * osc.open() // start server\n   * @example <caption>Using an existing HTTP server</caption>\n   * const http = require('http')\n   * const httpServer = http.createServer();\n   * const plugin = new OSC.WebsocketServerPlugin({ server: httpServer })\n   * const osc = new OSC({ plugin: plugin })\n   */\n  constructor(options) {\n    super()\n\n    // `WebSocketServer` gets replaced with an undefined value in builds\n    // targeting browser environments\n    if (!WebSocketServer) {\n      throw new Error('WebsocketServerPlugin can not be used in browser context')\n    }\n\n    /**\n     * @type {object} options\n     * @private\n     */\n    this.options = { ...defaultOptions, ...options }\n\n    /**\n     * @type {object} socket\n     * @private\n     */\n    this.socket = null\n    /**\n     * @type {number} socketStatus\n     * @private\n     */\n    this.socketStatus = STATUS.IS_NOT_INITIALIZED\n\n    /**\n     * @type {function} notify\n     * @private\n     */\n    this.notify = () => {}\n  }\n\n  /**\n   * Internal method to hook into osc library's\n   * EventHandler notify method\n   * @param {function} fn Notify callback\n   * @private\n   */\n  registerNotify(fn) {\n    this.notify = fn\n  }\n\n  /**\n   * Returns the current status of the connection\n   * @return {number} Status identifier\n   */\n  status() {\n    return this.socketStatus\n  }\n\n  /**\n   * Start a Websocket server. Defaults to global options\n   * @param {object} [customOptions] Custom options\n   * @param {string} [customOptions.host] Hostname of Websocket server\n   * @param {number} [customOptions.port] Port of Websocket server\n   */\n  open(customOptions = {}) {\n    const options = { ...this.options, ...customOptions }\n    const { port, host } = options\n    const rinfo = {\n      address: host,\n      family: 'wsserver',\n      port,\n      size: 0,\n    }\n\n    // close socket when already given\n    if (this.socket) {\n      this.close()\n    }\n\n    // create websocket server\n    if (options.server) {\n      this.socket = new WebSocketServer({ server: options.server })\n    } else {\n      this.socket = new WebSocketServer({ host, port })\n    }\n\n    this.socket.binaryType = 'arraybuffer'\n    this.socketStatus = STATUS.IS_CONNECTING\n\n    // register events\n    this.socket.on('listening', () => {\n      this.socketStatus = STATUS.IS_OPEN\n      this.notify('open')\n    })\n\n    this.socket.on('error', (error) => {\n      this.notify('error', error)\n    })\n\n    this.socket.on('connection', (client) => {\n      client.on('message', (message) => {\n        this.notify(new Uint8Array(message), rinfo)\n      })\n    })\n  }\n\n  /**\n   * Close Websocket server\n   */\n  close() {\n    this.socketStatus = STATUS.IS_CLOSING\n\n    this.socket.close(() => {\n      this.socketStatus = STATUS.IS_CLOSED\n      this.notify('close')\n    })\n  }\n\n  /**\n   * Send an OSC Packet, Bundle or Message to Websocket clients\n   * @param {Uint8Array} binary Binary representation of OSC Packet\n   */\n  send(binary) {\n    this.socket.clients.forEach((client) => {\n      client.send(binary, { binary: true })\n    })\n  }\n}\n","import {\n  isFunction,\n  isInt,\n  isObject,\n  isString,\n} from './common/utils'\n\nimport Bundle from './bundle'\nimport EventHandler from './events'\nimport Message, { TypedMessage } from './message'\nimport Packet from './packet'\n\nimport DatagramPlugin from './plugin/dgram'\nimport BridgePlugin from './plugin/bridge'\nimport WebsocketClientPlugin from './plugin/wsclient'\nimport WebsocketServerPlugin from './plugin/wsserver'\nimport Plugin from './plugin/plugin'\n\n/**\n * Default options\n * @private\n */\nconst defaultOptions = {\n  discardLateMessages: false,\n}\n\n/**\n * Status flags\n */\nconst STATUS = {\n  IS_NOT_INITIALIZED: -1,\n  IS_CONNECTING: 0,\n  IS_OPEN: 1,\n  IS_CLOSING: 2,\n  IS_CLOSED: 3,\n}\n\n/**\n * OSC interface to send OSC Packets and listen to status changes and\n * incoming message events. Offers a Plugin API for different network\n * protocols, defaults to a simple Websocket client for OSC communication\n * between a browser js-app and a js-node server\n *\n * @example\n * const osc = new OSC()\n *\n * osc.on('/input/test', message => {\n *   // print incoming OSC message arguments\n *   console.log(message.args)\n * })\n *\n * osc.on('open', () => {\n *   const message = new Message('/test/path', 55.12, 'hello')\n *   osc.send(message)\n * })\n *\n * osc.open({ host: '192.168.178.115', port: 9012 })\n */\nclass OSC {\n  /**\n   * Create an OSC instance with given options\n   * @param {object} [options] Custom options\n   * @param {boolean} [options.discardLateMessages=false] Ignore incoming\n   * messages when given timetag lies in the past\n   * @param {Plugin} [options.plugin=WebsocketClientPlugin] Add a connection plugin\n   * to this interface, defaults to a plugin with Websocket client.\n   * Open README.md for further information on how to handle plugins or\n   * how to write your own with the Plugin API\n   *\n   * @example\n   * const osc = new OSC() // default options with Websocket client\n   *\n   * @example\n   * const osc = new OSC({ discardLateMessages: true })\n   *\n   * @example\n   * const websocketPlugin = new OSC.WebsocketClientPlugin()\n   * const osc = new OSC({ plugin: websocketPlugin })\n   */\n  constructor(options) {\n    if (options && !isObject(options)) {\n      throw new Error('OSC options argument has to be an object.')\n    }\n\n    /**\n     * @type {object} options\n     * @private\n     */\n    this.options = { ...defaultOptions, ...options }\n    // create default plugin with default options\n    if (!this.options.plugin) {\n      this.options.plugin = new WebsocketClientPlugin()\n    }\n    /**\n     * @type {EventHandler} eventHandler\n     * @private\n     */\n    this.eventHandler = new EventHandler({\n      discardLateMessages: this.options.discardLateMessages,\n    })\n\n    // pass EventHandler's notify() to plugin\n    const { eventHandler } = this\n    if (this.options.plugin && this.options.plugin.registerNotify) {\n      this.options.plugin.registerNotify((...args) => eventHandler.notify(...args))\n    }\n  }\n\n  /**\n   * Listen to a status-change event or incoming OSC message with\n   * address pattern matching\n   * @param {string} eventName Event name or OSC address pattern\n   * @param {function} callback Function which is called on notification\n   * @return {number} Subscription id (needed to unsubscribe)\n   *\n   * @example\n   * // will be called when server receives /in!trument/* for example\n   * osc.on('/instrument/1', message => {\n   *   console.log(message)\n   * })\n   *\n   * @example\n   * // will be called for every message since it uses the wildcard symbol\n   * osc.on('*', message => {\n   *   console.log(message)\n   * })\n   *\n   * @example\n   * // will be called on network socket error\n   * osc.on('error', message => {\n   *   console.log(message)\n   * })\n   */\n  on(eventName, callback) {\n    if (!(isString(eventName) && isFunction(callback))) {\n      throw new Error('OSC on() needs event- or address string and callback function')\n    }\n\n    return this.eventHandler.on(eventName, callback)\n  }\n\n  /**\n   * Unsubscribe an event listener\n   * @param {string} eventName Event name or OSC address pattern\n   * @param {number} subscriptionId The subscription id\n   * @return {boolean} Success state\n   *\n   * @example\n   * const listenerId = osc.on('error', message => {\n   *   console.log(message)\n   * })\n   * osc.off('error', listenerId) // unsubscribe from error event\n   */\n  off(eventName, subscriptionId) {\n    if (!(isString(eventName) && isInt(subscriptionId))) {\n      throw new Error('OSC off() needs string and number (subscriptionId) to unsubscribe')\n    }\n\n    return this.eventHandler.off(eventName, subscriptionId)\n  }\n\n  /**\n   * Open network socket with plugin. This method is used by\n   * plugins and is not available without (see Plugin API for more information)\n   * @param {object} [options] Custom global options for plugin instance\n   *\n   * @example\n   * const osc = new OSC({ plugin: new OSC.DatagramPlugin() })\n   * osc.open({ host: '127.0.0.1', port: 8080 })\n   */\n  open(options) {\n    if (options && !isObject(options)) {\n      throw new Error('OSC open() options argument needs to be an object')\n    }\n\n    if (!(this.options.plugin && isFunction(this.options.plugin.open))) {\n      throw new Error('OSC Plugin API #open is not implemented!')\n    }\n\n    return this.options.plugin.open(options)\n  }\n\n  /**\n   * Returns the current status of the connection. See *STATUS* for\n   * different possible states. This method is used by plugins\n   * and is not available without (see Plugin API for more information)\n   * @return {number} Status identifier\n   *\n   * @example\n   * import OSC, { STATUS } from 'osc'\n   * const osc = new OSC()\n   * if (osc.status() === STATUS.IS_CONNECTING) {\n   *   // do something\n   * }\n   */\n  status() {\n    if (!(this.options.plugin && isFunction(this.options.plugin.status))) {\n      throw new Error('OSC Plugin API #status is not implemented!')\n    }\n\n    return this.options.plugin.status()\n  }\n\n  /**\n   * Close connection. This method is used by plugins and is not\n   * available without (see Plugin API for more information)\n   */\n  close() {\n    if (!(this.options.plugin && isFunction(this.options.plugin.close))) {\n      throw new Error('OSC Plugin API #close is not implemented!')\n    }\n\n    return this.options.plugin.close()\n  }\n\n  /**\n   * Send an OSC Packet, Bundle or Message. This method is used by plugins\n   * and is not available without (see Plugin API for more information)\n   * @param {Packet|Bundle|Message|TypedMessage} packet OSC Packet, Bundle or Message instance\n   * @param {object} [options] Custom options\n   *\n   * @example\n   * const osc = new OSC({ plugin: new OSC.DatagramPlugin() })\n   * osc.open({ host: '127.0.0.1', port: 8080 })\n   *\n   * const message = new OSC.Message('/test/path', 55.1, 57)\n   * osc.send(message)\n   *\n   * // send message again to custom address\n   * osc.send(message, { host: '192.168.178.115', port: 9001 })\n   */\n  send(packet, options) {\n    if (!(this.options.plugin && isFunction(this.options.plugin.send))) {\n      throw new Error('OSC Plugin API #send is not implemented!')\n    }\n\n    if (!(packet instanceof TypedMessage\n        || packet instanceof Message\n        || packet instanceof Bundle\n        || packet instanceof Packet)\n    ) {\n      throw new Error('OSC send() needs Messages, Bundles or Packets')\n    }\n\n    if (options && !isObject(options)) {\n      throw new Error('OSC send() options argument has to be an object')\n    }\n\n    return this.options.plugin.send(packet.pack(), options)\n  }\n}\n\n// expose status flags\nOSC.STATUS = STATUS\n\n// expose OSC classes\nOSC.Packet = Packet\nOSC.Bundle = Bundle\nOSC.Message = Message\nOSC.TypedMessage = TypedMessage\n\n// expose plugins\nOSC.Plugin = Plugin\nOSC.DatagramPlugin = DatagramPlugin\nOSC.WebsocketClientPlugin = WebsocketClientPlugin\nOSC.WebsocketServerPlugin = WebsocketServerPlugin\nOSC.BridgePlugin = BridgePlugin\n\nexport default OSC\n"],"names":["isInt","n","Number","isNumber","isString","isBoolean","isInfinity","Infinity","isArray","Object","prototype","toString","call","isObject","isFunction","isBlob","Uint8Array","isDate","Date","isUndefined","isNull","pad","hasProperty","name","hasOwnProperty","global","window","dataView","obj","buffer","DataView","ArrayBuffer","typeTag","item","Error","prepareAddress","address","concat","join","length","slice","prepareRegExPattern","str","replace","EncodeHelper","_createClass","_classCallCheck","this","data","byteLength","key","value","pack","push","result","offset","forEach","set","Atomic","method","initialOffset","arguments","undefined","AtomicInt32","_Atomic","_callSuper","_inherits","_get","_getPrototypeOf","STR_ENCODING","charCodesToString","charCodes","Buffer","from","TextDecoder","decode","Int8Array","i","String","fromCharCode","apply","AtomicString","terminated","charCodeAt","charcode","getUint8","SECONDS_70_YEARS","TWO_POWER_32","Timetag","seconds","fractions","milliseconds","rounded","Math","floor","round","AtomicTimetag","now","timetag","timestamp","getTime","_this$value","setInt32","getUint32","AtomicBlob","getInt32","AtomicFloat32","AtomicFloat64","MAX_INT64","BigInt","MIN_INT64","AtomicInt64","tmp","asIntN","MAX_UINT64","AtomicUInt64","asUintN","VALUE_TRUE","VALUE_FALSE","VALUE_NONE","VALUE_INFINITY","TypedMessage","args","_this","types","add","type","_this2","encoder","Helper","argument","index","merge","unpack","next","Message","_TypedMessage","_this3","oscArgs","_len","Array","_key","shift","map","BUNDLE_TAG","Bundle","bundleElements","ms","parentHead","head","size","Packet","defaultOptions","discardLateMessages","EventHandler","options","_objectSpread","addressHandlers","eventHandlers","open","error","close","uuid","packet","rinfo","bundle","bundleItem","dispatch","message","notify","success","handler","callback","handlerKeys","keys","handlers","foundMatch","regex","RegExp","test","lastIndex","reverseRegex","that","setTimeout","id","subscriptionId","haystack","some","splice","Plugin","constructor","binary","STATUS","DatagramPlugin","_Plugin","fn","socketStatus","customOptions","port","exclusive","socket","bind","host","send","ws","WebSocket","MozWebSocket","self","WebSocketServer","udpServer","udpClient","wsServer","receiver","mergeOptions","base","custom","BridgePlugin","wsServerOptions","server","websocket","binaryType","on","client","clients","secure","protocol","WebsocketClientPlugin","scheme","family","onopen","onclose","onerror","onmessage","WebsocketServerPlugin","OSC","plugin","eventHandler","registerNotify","eventName","off","status","IS_NOT_INITIALIZED","IS_CONNECTING","IS_OPEN","IS_CLOSING","IS_CLOSED"],"mappings":"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"}